<?xml version="1.0" encoding="ISO-8859-1"?>
<Invoice xmlns="urn:oasis:names:specification:ubl:schema:xsd:Invoice-2"
         {#include ubl/standard/include/namespaces.xml /}
>
    {#include ubl/standard/include/ubl-extensions.xml /}
    {#include ubl/standard/include/general-data.xml /}

    <cbc:InvoiceTypeCode listID="0101" listAgencyName="PE:SUNAT" listName="Tipo de Documento" listURI="urn:pe:gob:sunat:cpe:see:gem:catalogos:catalogo01">{tipoComprobante}</cbc:InvoiceTypeCode>
    <cbc:DocumentCurrencyCode listID="ISO 4217 Alpha" listAgencyName="United Nations Economic Commission for Europe" listName="Currency">{moneda}</cbc:DocumentCurrencyCode>

    {#include ubl/common/signature.xml /}
    {#include ubl/standard/include/supplier.xml /}
    {#include ubl/standard/include/customer.xml /}

    <cac:PaymentTerms>
        <cbc:ID>FormaPago</cbc:ID>
        <cbc:PaymentMeansID>{formaDePago}</cbc:PaymentMeansID>
        {#if formaDePago == 'Credito'}
        <cbc:Amount currencyID="{moneda}">{formaDePagoTotal.currency}</cbc:Amount>
        {/if}
    </cac:PaymentTerms>
    {#if formaDePagoCuotas}
    {#each formaDePagoCuotas}
    <cac:PaymentTerms>
        <cbc:ID>FormaPago</cbc:ID>
        <cbc:PaymentMeansID>Cuota{it_index}</cbc:PaymentMeansID>
        <cbc:Amount currencyID="{moneda}">{it.importe.currency}</cbc:Amount>
        <cbc:PaymentDueDate>{it.fechaPago}</cbc:PaymentDueDate>
    </cac:PaymentTerms>
    {/each}
    {/if}

    {#include ubl/standard/include/tax-total.xml /}

    <cac:LegalMonetaryTotal>
    {#include ubl/standard/include/monetary-total.xml /}
    </cac:LegalMonetaryTotal>

    {#each detalle}
    <cac:InvoiceLine>
        <cbc:ID>{it_index.add(1)}</cbc:ID>
        <cbc:InvoicedQuantity unitCode="{it.unidadMedida}" unitCodeListAgencyName="United Nations Economic Commission for Europe" unitCodeListID="UN/ECE rec 20">{it.cantidad}</cbc:InvoicedQuantity>
        {#include ubl/standard/include/document-line.xml item=it /}
    </cac:InvoiceLine>
    {/each}
</Invoice>
